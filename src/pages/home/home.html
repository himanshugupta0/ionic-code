<ion-header>
  <ion-navbar>
    <ion-title>Munshiji247</ion-title>
    <!-- <ion-buttons end>
      <a ion-button icon-only (click)="scrollToBottom(1000)">
        <i style="color:#32db64;" class="fa fa-level-down" aria-hidden="true"></i>
      </a>
    </ion-buttons> -->
    <ion-buttons end>
      <a ion-button icon-only (click)="openPopover($event)">
        <ion-icon name="more"></ion-icon>
      </a>
    </ion-buttons>
  </ion-navbar>
</ion-header>
<ion-content #content class="scrollbar">

  <div>

    <template no-lines ngFor let-element [ngForOf]="elements">

      <ion-list no-lines *ngIf="element.type == 'message'">
        <div *ngFor="let message of element.values">
          <ion-item *ngIf="message.msg == 'Create a new service from these categories.' && shouldHideCreateService == true">
            <chat-bubble-msg [chatMessage]="message"></chat-bubble-msg>
          </ion-item>
          <ion-item id="trackScroll" *ngIf="message.msg != 'Create a new service from these categories.'">
            <chat-bubble-msg [chatMessage]="message"></chat-bubble-msg>
          </ion-item>
        </div>
      </ion-list>

      <ion-row id="scrollTop" wrap *ngIf="element.type == 'tile'" class="chatContent">
        <ion-col col-6 *ngFor="let tile of element.values;let i = index">
          <card-tile [cardTiles]="tile" (click)="showNode(tile, i,'selectedTile') "></card-tile>
        </ion-col>
      </ion-row>

      <a></a>

      <ion-row id="scrollCard" wrap *ngIf="element.type == 'service_card' && shouldHide==true" class="chatContent">
        <ion-col col-6 *ngFor="let card of element.values;let i = index">
          <card-tile [cardTiles]="card" (click)="showNode(card, i,'selectedService') "></card-tile>
        </ion-col>
      </ion-row>

      <ion-row id="scroll_card" wrap *ngIf="element.type == 'card'&& shouldHideServices==true" class="chatContent">
        <ion-col col-6 *ngFor="let card of element.values;let i = index">
          <card-design [cardDetails]="card" (click)="showNode(card, i,'selectedCard') "></card-design>
        </ion-col>
      </ion-row>

      <ion-row id="scrollTrack" wrap *ngIf="element.type == 'list'" class="chatContent">
        <ion-col col-6 *ngFor="let list of element.values;let i = index">
          <card-design-track [cardDetailsTrack]="list" (click)="showNode(list, i, selectedList) "></card-design-track>
        </ion-col>
      </ion-row>


      <ion-list *ngIf="element.type == 'timeline'">
        <ion-item *ngIf="element.values==0">
          <p class="noUpdates">There are no updates to show</p>
        </ion-item>
        <div class="chatContent">
          <div *ngFor="let msg of element.values">
            <timeline-view [timelineData]="msg"></timeline-view>
          </div>
        </div>
      </ion-list>

      <ion-list no-lines *ngIf="element.type == 'chat_message'">
        <ion-item *ngFor="let msg of element.values">
          <chat-bubble-msg [chatMessage]="msg"></chat-bubble-msg>
        </ion-item>
      </ion-list>

    </template>

    <ion-row class="chatContent">
      <button ion-button small *ngIf="level>1" (click)="scrollToTop()" color="secondary">
        Back to Start
      </button>
    </ion-row>
  </div>
</ion-content>

<!--Chat input footer-->
<!--<ion-footer *ngIf="chatFooterEnabled" no-border class="chatPageFooter" [keyboardAttach]="content" [btnClicked]="btnEmitter">
  <ion-toolbar>
    <elastic-textarea #txtChat placeholder="Send a message" maxExpand="5"></elastic-textarea>
    <ion-buttons right>
      <button right ion-button icon-only [disabled]="txtChat.content.trim().length<1" (click)="sendMessage()">
        <ion-icon style="color: #5598FB;" name="md-send"></ion-icon>
      </button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>-->

<ion-footer style="background: white;" *ngIf="chatFooterEnabled" no-border class="chatPageFooter" [keyboardAttach]="content"
  [btnClicked]="btnEmitter">
  <ion-card *ngIf="showAttachmentDiv==true" class="cardAction">
    <div style="padding: 3%;width: 100%;margin-left: 5%;">
      <div style="width:30%;float:left;text-align: center;">
        <button (click)="onClickDone()" style="padding: 10%;border-radius: 50px;background: #5598FB;">
          <i style="color:white;" class="fa fa-thumbs-up fa-2x" aria-hidden="true"></i>
        </button>
        <ion-label style="width: 100%;text-align:center;color: #5598FB;">
          Done
        </ion-label>
      </div>
      <div style="width:30%;float:left;text-align: center;">
        <button (click)="onClickCheckIn()" style="padding: 10%;border-radius: 50px;background: #5598FB;">
          <i style="color:white;" class="fa fa-map-marker fa-2x" aria-hidden="true"></i>
        </button>
        <ion-label style="width: 100%;text-align:center;color: #5598FB;">
          Check-In
        </ion-label>
      </div>
      <div style="width:30%;float:left;text-align: center;">
        <button (click)="onClickTakePic()" style="padding: 10%;border-radius: 50px;background: #5598FB;">
          <i style="color:white;text-align:center;" class="fa fa-camera-retro fa-2x" aria-hidden="true"></i>
        </button>
        <ion-label style="width: 100%;text-align:center;color: #5598FB;">
          Take-Picture
        </ion-label>
      </div>
      <div style="width:30%;float:left;text-align: center;">
        <button (click)="onClickTakeVideo()" style="padding: 10%;border-radius: 50px;background: #5598FB;">
          <i style="color:white;text-align:center;" class="fa fa-video-camera fa-2x" aria-hidden="true"></i>
        </button>
        <ion-label style="width: 100%;text-align:center;color: #5598FB;">
          Capture-Video
        </ion-label>
      </div>
      <div style="width:30%;float:left;text-align: center;">
        <button (click)="onClickTakeSignature()" style="padding: 10%;border-radius: 50px;background: #5598FB;">
          <i style="color:white;text-align:center;" class="fa fa-pencil-square-o fa-2x" aria-hidden="true"></i>
        </button>
        <ion-label style="width: 100%;text-align:center;color: #5598FB;">
          Take-Signature
        </ion-label>
      </div>
      <div style="width:30%;float:left;text-align: center;">
        <button (click)="onClickWriteNote()" style="padding: 10%;border-radius: 50px;background: #5598FB;">
          <i style="color:white;text-align:center;" class="fa fa-sticky-note-o fa-2x" aria-hidden="true"></i>
        </button>
        <ion-label style="width: 100%;text-align:center;color: #5598FB;">
          Write Note
        </ion-label>
      </div>
      <div style="width:30%;float:left;text-align: center;">
        <button (click)="onClickScanBarcode()" style="padding: 10%;border-radius: 50px;background: #5598FB;">
          <i style="color:white;text-align:center;" class="fa fa-barcode fa-2x" aria-hidden="true"></i>
        </button>
        <ion-label style="width: 100%;text-align:center;color: #5598FB;">
          Scan Barcode
        </ion-label>
      </div>
    </div>    
  </ion-card>
  
  <div style="background:white;">
    <ion-toolbar>
      <form [formGroup]="chatForm">
        <div style="width: 88%;float:left;min-height: 34px;background-color: #F4F4F4;border: 1px solid #F4F4F4;border-radius: 20px;padding: 5px;box-shadow: 0 2px 5px 0 rgba(0,0,0,0.16), 0 2px 10px 0 rgba(0,0,0,0.12);">
          <!-- <div *ngIf="showAttachmentIcon == true" (click)="onClickPlus()" style="float:left;margin-left: 0;margin-right: 3%;margin-top: 2%;width:4%; padding:1%">
            <i style="color: #5598FB;margin-left: -35%;float:left;font-size: 140%;" class="fa fa-plus" aria-hidden="true"></i>
          </div> -->

          <div class="attachmentIcon {{showAttachmentIcon == true ? 'withplus' : 'withoutplus'}}">
            <i *ngIf="showAttachmentIcon == true" (click)="onClickPlus()" style="color: #5598FB;float:left;font-size: 140%;width: 10%;margin-top: 2%;margin-left: 2%;" class="fa fa-plus" aria-hidden="true"></i>
            <input [(ngModel)]="inputmsg" formControlName="chatMessage" style="width: 84%;background-color: #F4F4F4;border: 1px solid #F4F4F4;" name="msg" required placeholder="Send a message" maxExpand="5" />
            
          </div>

        </div>
        <div style="width:10%;float:left;margin-left: 1.5%;">
          <ion-buttons right>
              <button right ion-button icon-only style="background: #5598FB; border-radius: 50%;margin-bottom: -20%;" (click)="sendMessage()">
                <ion-icon style="color: white;" name="md-send"></ion-icon>
              </button>
            </ion-buttons>
        </div>
      </form>

    </ion-toolbar>
  </div>
</ion-footer>


<!--Response input footer-->
<ion-footer *ngIf="inputFooterEnabled" no-border class="chatPageFooter" [keyboardAttach]="content" [btnClicked]="btnEmitter">
  <ion-toolbar>
    <ion-buttons left *ngIf="showAttachmentIcon == true" style="margin-right: -3%;background: transparent;">
      <button right ion-button icon-only (click)="onClickPlus()">
          <i style="color: #5598FB;font-size: 150%;margin-bottom: -30%;" class="fa fa-plus" aria-hidden="true"></i>
      </button>
    </ion-buttons>
    <div style="width: 98%;">
      <elastic-textarea #createServiceReply placeholder="Reply" maxExpand="5"></elastic-textarea>
    </div>
    <ion-buttons right>
      <button ion-button style="background: #5598FB; border-radius: 100%;" icon-only [disabled]="createServiceReply.content.trim().length<1" (click)="showFormData(currentNum)">
        <ion-icon style="color: white;" name="md-send"></ion-icon>
      </button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>
